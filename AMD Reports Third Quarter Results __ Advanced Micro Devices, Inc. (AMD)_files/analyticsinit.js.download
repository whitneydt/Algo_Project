/* ! _load_js v1.0.4 */

/*
 * Analytics Initialization Custom Script
 * Last Update 9:28 EST 04/17/2018
 */

(function (window) {

  'use strict';

  /**
   * load external js asynchronously
   * @param  {string} src  JavaScript file to be loaded
   * @param  {Function} done Optional callback function to execute once script file loads successfully
   */

  window._load_js = function (src, done) {
    var js = document.createElement('script');
    var head = document.getElementsByTagName('head')[0] || document.documentElement;
    var isDone = false;
    js.src = src;
    js.type = 'text/javascript';
    js.async = true;

    /**
     * Handle Script loading error
     */

    js.onerror = function () {
      throw new Error('Unable to load script: ' + js.src);
    };

    /**
     * Handle Script loading success
     */

    js.onload = js.onreadystatechange = function () {
      if (!isDone && (!this.readyState || (this.readyState === 'complete' || this.readyState === 'loaded' && this.nextSibling !== null))) {
        isDone = true;
        if (done) {
          done();
        }

        // remove listeners
        js.onload = js.onreadystatechange = null;
      }
      else {
        if (this.readyState === 'loaded' && this.nextSibling === null) {
          throw new Error('Unable to load script: ' + js.src);
        }
      }
    };

    // head.insertBefore(js, head.firstChild);
    head.appendChild(js);
  };

  window.core = function () {
    window._load_js('//download.amd.com/js/analytics/analyticscore.js?v=1.0.0', window.secondary);
  };

  window.secondary = function () {
    window._load_js('//download.amd.com/js/analytics/analyticssecondary.js?v=1.0.0');
  };

  // load jQuery if not present
  if (typeof jQuery === 'undefined') {
    window._load_js('//download.amd.com/js/jquery.min.3.2.1.js', window.core);
  }
  else {
    window.core();
  }
})(window);
